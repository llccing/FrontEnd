<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[译]在 Angular 中使用拦截器的方式 Top 10 | Rowan Liu's Tech</title><meta name="description" content="just do it! ">
    <link rel="preload" href="/FrontEnd/assets/style-Dgw7cJie.css" as="style"><link rel="stylesheet" href="/FrontEnd/assets/style-Dgw7cJie.css">
    <link rel="modulepreload" href="/FrontEnd/assets/app-DxUSmTbc.js"><link rel="modulepreload" href="/FrontEnd/assets/Top 10 ways to use Interceptors in Angular.html-CEnNrtfM.js">
    <link rel="prefetch" href="/FrontEnd/assets/index.html-MI6RX2_A.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-CREATE.html-C3BOl5ec.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-SELECT.html-BcYMGBfs.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/03-GROUP BY.html-Cg3ulff8.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-CzRbdv1N.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DpNwstFa.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/PAC.html-BWquVteU.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-C79xyKlO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Block-Formatting-Context.html-CvpaV7fo.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/flex.html-Db0t7dNC.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/grid.html-DaVKdh5U.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/inline-block.html-D3RUYwEq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/layout.html-Brvz720x.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/preprocess.html-BeYexCNk.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DlxXJkfb.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/rem.html-AJdC53oP.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/responsive-web-design.html-BTEEx45v.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/selector.html-C8ppaHyA.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BqhZNDZg.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DpuaxAE-.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-JR6z1KSt.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-C7nrG9Xn.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-CCRIpC5u.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BU432prd.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/OOP.html-DxWG6NRy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DTj1Okbe.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/validateForm.html-BHN99sVz.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-D-eOTBWT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/css.html-vQ2kt3Cd.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/js.html-BOPpzKj2.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Node.js Architecture and 12 Best Practices for Node.js Development.html-BNQcnSj1.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-Br6Uxvk3.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/core-js@3_ babel and a look into the future.html-DIiW2Je9.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/making-vue-3.html-BJS-aLyK.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vue-cli-plugin-dev.html-DnyNknD1.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vue-cli-plugin-eslint-readme.html-DKQ81fiv.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vue-cli-plugin-typescript-readme.html-CPtE4tD7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/what-you-need-know-about-Vue-3-in-2020.html-DTccWmeE.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/2018-dev-guide.html-BKRIXcZI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/FrontEndLive.html-CrSGnwRf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/architecture.html-CnF_pAWb.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ci.html-BeKyTI33.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/for.html-D_wWMQWb.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/gzip.html-RniRzrY5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/jQuery.html-CXXNfO_q.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/lerna.html-D97yLFJO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/useGulp.html-Ef0avzpp.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vue-cli2-to-vue-cli3.html-BlnPvU2Y.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vue3.html-Y7rDZEy5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vueComponent.html-DhS_0nXO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-Reflect-Metadata.html-BonjDoy7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BWMs7XmD.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Generator-async.html-ucxRVnO0.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Generator.html-o8gmw2J5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Iterator-for...of.html-FyrwcyVX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Promise.html-BZ9D4V87.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Proxy-Reflect.html-d5hTsF8L.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Set-Map.html-CTptHIpJ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/String-extension.html-D97uoyuw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Symbol.html-8J2b8zod.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/async-await-promise.html-4A2ouMX4.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/function-extension.html-DRdXhrcg.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/let-const.html-BocQ42qy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/number-extension.html-BQ9zn8II.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/object-extension.html--AUDheCc.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DkhFJG0g.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/variable-destructor-assignment.html-BfXXHVpe.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ajax.html-DErdzPdH.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/apply-call.html-DGD2eDnR.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/arguments.html-BGikcg_3.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/calc-box-size.html-Yyh2mfVI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/cookie.html-Clnrj-Et.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/drag.html-sHG1FHJJ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-change-detection.html-DMXmjNRh.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-view-engine-vs-ivy.html-CkQrSkrM.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/03-zone.html-DjAwoaGT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/04-version-update.html-CPAoWfhv.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BqggozYG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/init.html-BYUpEIXI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-NHZUHm8C.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-CFs2e0gT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-WdL7tpi7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-OAuth_2.0.html-CSJbon7J.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/03-MongoDB.html-CCLjXr97.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/lots_of_passport.html-DnUdByCO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/sso.html-BLdh4pMO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/00-react.html-BJneuYGX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-start-project.html-DUOuytUv.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-a-language.html-ghLn70Or.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/00-vue.html-Ciq_JKuu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-flow.html-BumrJ4xk.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-src-structure.html-BmQW0XOY.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/03-compile.html-CwGgwprV.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/04-entry.html-CRAeBNJO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/10-data-driven.html-CHQEPszc.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/11-new-Vue.html-xzxqGXoy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/12-vue-mounted.html-AVltkMX8.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/13-render.html-CTAJNmqT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/14-virtual-DOM.html-BcwsaWU1.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/15-createElement.html-DrHu9ny2.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/16-update.html-Bhm_uDII.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/20-components.html-VgNhMODi.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/30-responsive.html-CrnJT01w.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BM5T9s7j.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-C5wDd9ug.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/vs-build-size.html-CHrJnrQq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-remark.html-CnTiWUJN.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DBYLzRGM.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/webpack-5-federated-module.html-NvKo3KBL.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/cnodejs.html-QtAOCrCj.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-overview.html-BPmhFYP0.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-terminology-concept.html-BFRlcJ68.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01.html-DetkOp-O.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-F58VHCqt.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Artifact.html-rI727GZg.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Audit-Manager.html-D1Ca5RK5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Bedrock.html-iRJFLmSJ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Comprehend.html-BUpM9Ket.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Data-Exchange.html-CP-yXiTE.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Inspector.html-D8k5jX07.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Lex.html-DW_Dh45Z.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Macie.html--LVigAJt.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/OpenSearch-Service.html-CBBskO5S.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Personalize.html-Jhi1WLHH.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Q-developer.html-h-VfPS6y.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/QuickSight.html-BV1YQqo_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SageMaker.html-AJLPBelO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Transcribe.html-Bn9cSjfy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Trusted-Advisor.html-snqR52w7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/BERTScore.html-CtsZ7JW5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CFG-scale.html-CuPp2tNf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Epoch.html-I-PSaOpP.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/F1-Store.html-BeqLNN84.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Generate-pre-trained-Transformers.html-DZrBExRu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Generative-adversarial-network.html-DzDZToHI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Hallucination.html-DQopepHh.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Matrix-Confusion.html-CiDxocbW.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Matrix-Correlation.html-YK82qz84.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Matrix-Mean-Squared-Error.html-BKIXTnBH.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Matrix-R2-score.html-CLECEeG_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/RLHF.html-0biuWvt4.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Recall-Oriented Understudy.html-vG3mhxI8.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Reinforcement-learning.html-C7q4vj0x.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Residual-neural-network.html-CAx1Bm00.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Responsible-generative-ai.html-CmhKkCBx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Supervised-learning.html-Cmmzg03h.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Support-vector-machine.html-CKplNxVa.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Transfer-learning.html-CNGcUkGA.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Unsupervised-learning.html-DMREUXfI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/WaveNet.html-s8BIL1Yy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/XGBoost.html-BmS6mCJ4.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/019-train.html-D_EJ3FyW.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/021-OpenSearch-Service.html-DADTCywf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/024-prompt-engineering.html-B9OuCAgm.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/029-Prompt-injection.html-CKvVrSbS.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/030-security-responsibility.html-C23Dd3tl.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/031-image-classify.html-3zrd6PaL.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/032-GPT.html-CvyHWkN8.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/036-Inference.html-CTPK24yB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/041-Epoch.html-Bp8It3QA.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/043-SageMaker-Clarify.html-BFvuZJLv.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/044-performance-decreased.html-CqbhAA-p.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/046-chat-with-PDF.html-CvsDE6du.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/047-evalute-the-output.html-CdmBdm64.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/048-aligns-FM.html-Bp41c0e5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/049-responsive-minimize-bias.html-DiGEviu6.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/050-must-do-to-custom-model-bedrock.html-Ba5Jj6ca.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/053-ec2-ai-type.html-DQuhQAro.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/055-type-of-model.html-ywvQ8kC4.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/057-sampling-bias.html-7XF7TlEf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/058-RL.html-Bqu_6sMk.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/059-matrix.html-CIT_jk61.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/060-find-offensive.html-PpDYa9RI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/062-offline-large-data-process.html-DzzcpqgK.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/064-fine-turning.html-DSjma3cX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/065-temperatrue-high-low.html-CjznMnC9.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/066-security-policy.html-Cqi9SKow.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/070-strategy-of-img-classification.html-FxrijtZ6.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/072-few-shot.html-f06tbgPg.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/073-bedrock-on-demand-pay.html-CRvvj4jX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/074-hallucination.html-C8Z97VVI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/075-confidential-data.html-B7dEKrYm.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/076-BLEU.html-D06krtcf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/077-agents-in-bedrock.html-ZKCRNQ5N.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/078-ongoing-pre-training.html-Xv-gsvsQ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/081-s3-to-SageMaker.html-i-gibkZo.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/083-prompting-attack.html-DZUYv--K.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/087-SageMaker-network-isolation.html-CUMegZtB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/089-developer-tools.html-CbvPcZq7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/092-Adversarial-prompting.html-CIQSCa9o.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/093-judge-fine-tuned-LLM.html-BsOoNsdG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/094-CFG-scale.html-IrQvO0Bg.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/097-Fairness.html-DBbeFs1G.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/099-BERTScore.html-CMo5iQMN.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/100-K-NN.html-CJ35lj99.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/001-250107.html-B2vLzUoU.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0011-250321.html-CbWclq9J.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/002-250113.html-ESQXgEIT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0021-250323.html-CvVyvTng.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/003-250115.html-COqTbNGp.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0031-250324.html-B86Lg17Z.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/004-250119.html-BbeR74V0.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0041-250408.html-dV03wyBw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/005-250130.html-HlRHFZMI.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0051-250414.html-DaHJZzVX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/006-250203.html-DDNiOMC_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0061-250505.html-BA9Z2kFZ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/APIGateway.html-CyiUppE3.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/AppFlow.html-Db_8KTvT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Athena.html-Cg-YCZuG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Aurora.html-CoXwXIVE.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/AutoScaling.html-Dq2bhRt_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Backup.html-DEGn5uzA.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CertificateManager.html-cLR6z0EQ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CloudFormation.html-9bS-cfmB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CloudFront.html-BSY31bFB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CloudTrail.html-C_aq5rCq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/CloudWatch.html-5-LuKHqh.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Cognito.html-Dlelvz5v.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Comprehend.html-ebq8oYCv.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ComprehendMedical.html-BAcZaYLB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Config.html-C10C1-3G.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ControlTower.html-BtOmlx4C.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DR.html-2ILzbsPX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DataSync.html-BuPvGjV_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DatabaseCaching.html-Bv5Tf5MJ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DatabaseMigrationService.html-WdIFb76u.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DirectConnect.html-C_VXS5-o.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DirectoryService.html-ULNAzhrx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DynamoDB.html-BEq70Cyx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/DynamoDBAccelerator.html-BNU-hhPh.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EBS.html-DFWQy7P3.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EC2.html-CjveUU9Q.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EC2AutoScaling.html-i83cS38-.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ECS.html-Dsz5Mljj.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EFS.html-B6EODsAE.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EKS.html-BXOWYLAc.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ELB.html-D3NvQzfx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EMR.html-DWD8wErL.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ElasticBeantalk.html-DWQRO7-S.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/ElasticCache.html-cPRLDDbU.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/EventBridge.html-Dhra8J10.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/FSxFileGateway.html-CcDh-RTM.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/FSxForLustre.html-Yhfc3gLT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/FXsForWindowsFileServer.html-B72E7GAD.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Fargate.html-8SpZFFXF.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/FirewallManager.html-xlzkEfyN.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/GlobalAccelerator.html-C32v3ZRq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Glue.html-MRSfyIH6.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/GuardDuty.html-Bfx0SQzn.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/IAM.html-DtqMUIVV.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Inspector.html-mERx7aVF.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/KMS.html-SB1DCPw_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/KinesisDataFirehose.html-BYcyiuSB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/KinesisDataStream.html-Cdab5Xaa.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/LakeFormation.html-CuO13CPw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Lambda.html-N_92XIDG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/MQ.html-CMeKm6DS.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Macie.html-DuDxJL1Y.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/NetworkFirewall.html-DTKOswTy.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/OpenSearchService.html-CD8W9_ps.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Orgnizations.html-D2_DoOZO.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/PrivateLink.html-DwdlIF5W.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/QuickSight.html-BR_c8uE0.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/RDS.html-DLgjPKm_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/RDSProxy.html-bIZLZFeq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/RedShift.html-edBWVsoP.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Rekognition.html-BYegYocX.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Route53.html-DuNpJhAW.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/S3.html-BcW0Nlm1.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SNS.html-AKt9S0MP.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SQS.html-CTToTOMY.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SageMaker.html-CIal8JP9.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SecretsManager.html-3jVCsdMC.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Shield.html-DiBw6WJK.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SnowFamily.html-Ca3WqxrM.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/StorageGateway.html-Cg6eI-K3.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/SystemsManager.html-H6b592yo.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Textract.html-Ydy-eCAu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/TransferFamily.html-BFE1TWy9.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/TransitGateway.html-bTymTnZK.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/VPC.html-CtDXPaDf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/WAF.html-YH_18ZJw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/01-general.html-B6cZQMp5.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/02-providers.html-CwN1Wc5D.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/03-apis.html-D1U5v2kw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/04-operations.html-B47mbx7l.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BXksl1Iw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-CVbYjV-c.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-Diu7KXqw.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-B5rQHbHA.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-mjgIP1xH.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-B9TrOCZ8.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BeEfbVD0.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-BSOW3ycG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-CCZEM30K.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/index.html-DxZBSICY.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-01-10.html-CDgXoL_i.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-11-20.html-CiUaDtc2.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-21-30.html-EmcN0uSu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-31-40.html-DyTvUS4O.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-41-50.html-Cn7dkPiB.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/Self-test-51-60.html-DL6YL-cx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/wrong-list.html-MX6jFz-X.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0000-Questions.html-B1R9RPlc.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0001-Answers.html-BKHWutmf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0010-Questions.html-CbJheEgM.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0011-Answers.html-BXDle9TL.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0020-Questions.html-CZ1ltf8a.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0021-Answers.html-4DmaxOIl.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0030-Questions.html-DSx0q978.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0031-Answers.html-DGrodcfF.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0040-Questions.html-D6ZK9nS7.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0041-Answers.html-DuYEEFvf.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0050-Questions.html-Ymm7EV4_.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0051-Answers.html-DKTBrhg1.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0060-Questions.html-wbYLBdCo.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0061-Answers.html-Wn8KAKn9.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0070-Questions.html-CZCw5Rvu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0071-Answers.html-NCSLx_7i.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0080-Questions.html-BA8S3ZGH.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0081-Answers.html-DXCWMy0i.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0090-Questions.html-D8jxZmk6.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0091-Answers.html-SSfFqG2r.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0100-Questions.html-DVxXpfWq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0101-Answers.html-d31dbAGG.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0110-Questions.html-BiESxucT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0111-Answers.html-5DP2F_QN.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0120-Questions.html-c_ElI9qx.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0121-Answers.html-BAoqHzYT.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0130-Questions.html-CTzGUeXK.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0131-Answers.html-BJAq1tae.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0140-Questions.html-ENjC5hzu.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0141-Answers.html-CiorFWFN.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0150-Questions.html-BO7D13rq.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0151-Answers.html-4duh023G.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0160-Questions.html-C_A1Y1XF.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0161-Answers.html-DYMA8W1S.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0170-Questions.html-C567h1EJ.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0171-Answers.html-DvEtB6lL.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0180-Questions.html-rfo9PIPR.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0181-Answers.html-DWIS5F6f.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0190-Questions.html-CYe6sdSR.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/0191-Answers.html-BIpOn6ii.js" as="script"><link rel="prefetch" href="/FrontEnd/assets/404.html-yqaA_6Ts.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/FrontEnd/"><!----><span class="vp-site-name" aria-hidden="true">Rowan Liu&#39;s Tech</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/FrontEnd/blog/" aria-label="Blog"><!--[--><!--[--><!--]--><!--]-->Blog<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/css/" aria-label="CSS"><!--[--><!--[--><!--]--><!--]-->CSS<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/js/" aria-label="JS"><!--[--><!--[--><!--]--><!--]-->JS<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/lib/" aria-label="lib"><!--[--><!--[--><!--]--><!--]-->lib<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/read/" aria-label="Read"><!--[--><!--[--><!--]--><!--]-->Read<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://rowanliu.com/about" aria-label="About" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->About<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/llccing/FrontEnd" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/FrontEnd/blog/" aria-label="Blog"><!--[--><!--[--><!--]--><!--]-->Blog<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/css/" aria-label="CSS"><!--[--><!--[--><!--]--><!--]-->CSS<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/js/" aria-label="JS"><!--[--><!--[--><!--]--><!--]-->JS<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/lib/" aria-label="lib"><!--[--><!--[--><!--]--><!--]-->lib<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/FrontEnd/read/" aria-label="Read"><!--[--><!--[--><!--]--><!--]-->Read<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://rowanliu.com/about" aria-label="About" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->About<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/llccing/FrontEnd" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->GitHub<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item vp-sidebar-heading" href="/FrontEnd/blog/" aria-label="在专精的路上走的一发不可收拾"><!--[--><!--[--><!--]--><!--]-->在专精的路上走的一发不可收拾<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">生活有感 <span class="right arrow"></span></p><ul class="vp-sidebar-children" style="display:none;"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/lerna.html" aria-label="lerna"><!--[--><!--[--><!--]--><!--]-->lerna<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/jQuery.html" aria-label="jQuery实践"><!--[--><!--[--><!--]--><!--]-->jQuery实践<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/gzip.html" aria-label="gzip"><!--[--><!--[--><!--]--><!--]-->gzip<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/2018-dev-guide.html" aria-label="2018 Web开发,实用指南"><!--[--><!--[--><!--]--><!--]-->2018 Web开发,实用指南<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/for.html" aria-label="for 追求"><!--[--><!--[--><!--]--><!--]-->for 追求<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/ci.html" aria-label="Travis CI"><!--[--><!--[--><!--]--><!--]-->Travis CI<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/useGulp.html" aria-label="前端基础设施(gulp)"><!--[--><!--[--><!--]--><!--]-->前端基础设施(gulp)<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/FrontEndLive.html" aria-label="知乎Live--前端工程师的职业规划"><!--[--><!--[--><!--]--><!--]-->知乎Live--前端工程师的职业规划<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/architecture.html" aria-label="前端架构演进"><!--[--><!--[--><!--]--><!--]-->前端架构演进<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/vueComponent.html" aria-label="组件的重写"><!--[--><!--[--><!--]--><!--]-->组件的重写<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/vue-cli2-to-vue-cli3.html" aria-label="vue-cli2 to vue-cli3"><!--[--><!--[--><!--]--><!--]-->vue-cli2 to vue-cli3<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/life/vue3.html" aria-label="vue3"><!--[--><!--[--><!--]--><!--]-->vue3<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active collapsible">翻译 <span class="down arrow"></span></p><ul class="vp-sidebar-children" style=""><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/" aria-label="开篇"><!--[--><!--[--><!--]--><!--]-->开篇<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/FrontEnd/blog/translate/Top%2010%20ways%20to%20use%20Interceptors%20in%20Angular.html" aria-label="[译]在 Angular 中使用拦截器的方式 Top 10"><!--[--><!--[--><!--]--><!--]-->[译]在 Angular 中使用拦截器的方式 Top 10<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/what-you-need-know-about-Vue-3-in-2020.html" aria-label="2020年关于 Vue 3 你需要知道的事"><!--[--><!--[--><!--]--><!--]-->2020年关于 Vue 3 你需要知道的事<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/core-js@3_%20babel%20and%20a%20look%20into%20the%20future.html" aria-label="core-js@3, babel展望未来"><!--[--><!--[--><!--]--><!--]-->core-js@3, babel展望未来<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/vue-cli-plugin-dev.html" aria-label="Vue CLI 插件开发指南"><!--[--><!--[--><!--]--><!--]-->Vue CLI 插件开发指南<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/vue-cli-plugin-typescript-readme.html" aria-label="@vue/cli-plugin-typescript README"><!--[--><!--[--><!--]--><!--]-->@vue/cli-plugin-typescript README<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/vue-cli-plugin-eslint-readme.html" aria-label="@vue/cli-plugin-eslint"><!--[--><!--[--><!--]--><!--]-->@vue/cli-plugin-eslint<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/translate/making-vue-3.html" aria-label="Vue 3 的开发进展"><!--[--><!--[--><!--]--><!--]-->Vue 3 的开发进展<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">那些年我面过的试 <span class="right arrow"></span></p><ul class="vp-sidebar-children" style="display:none;"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/interview/" aria-label="开篇"><!--[--><!--[--><!--]--><!--]-->开篇<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/interview/js.html" aria-label="JavaScript"><!--[--><!--[--><!--]--><!--]-->JavaScript<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/interview/css.html" aria-label="css"><!--[--><!--[--><!--]--><!--]-->css<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">数据结构 <span class="right arrow"></span></p><ul class="vp-sidebar-children" style="display:none;"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/dataStructure/" aria-label="排序"><!--[--><!--[--><!--]--><!--]-->排序<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading collapsible">设计模式 <span class="right arrow"></span></p><ul class="vp-sidebar-children" style="display:none;"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/design-pattern/" aria-label="开篇"><!--[--><!--[--><!--]--><!--]-->开篇<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/design-pattern/OOP.html" aria-label="OOP"><!--[--><!--[--><!--]--><!--]-->OOP<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/FrontEnd/blog/design-pattern/validateForm.html" aria-label="表单验证"><!--[--><!--[--><!--]--><!--]-->表单验证<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h1 id="译-在-angular-中使用拦截器的方式-top-10" tabindex="-1"><a class="header-anchor" href="#译-在-angular-中使用拦截器的方式-top-10"><span>[译]在 Angular 中使用拦截器的方式 Top 10</span></a></h1><blockquote><p><a href="https://medium.com/angular-in-depth/top-10-ways-to-use-interceptors-in-angular-db450f8a62d6" target="_blank" rel="noopener noreferrer">原文在此，也可以看原文哦</a></p></blockquote><p>有许多种方式使用拦截器，我确定我们大多数人使用的很浅显。在这篇文章中，我将介绍在 Angular 中我最喜欢的 10 种使用拦截器的方式。</p><p>我使例子尽可能的简洁。我希望他们能够启发你们去思考使用拦截器的新方式。这篇文章不是关于拦截器教学的，因为已经有很多好的文章了。但是，在开始倒数之前，让我们以一些基础的知识点开始。</p><h2 id="httpinterceptor-101" tabindex="-1"><a class="header-anchor" href="#httpinterceptor-101"><span>HttpInterceptor 101</span></a></h2><p><a href="https://angular.io/api/common/http/HttpInterceptor" target="_blank" rel="noopener noreferrer">HttpInterceptor</a> 是在 Angular 4.3 引入。它提供一种方式拦截 HTTP 请求和响应，在传递他们之前转换或者处理他们。</p><blockquote><p>尽管拦截器能够改变请求和响应，但是 <a href="https://angular.io/api/common/http/HttpRequest" target="_blank" rel="noopener noreferrer">HttpRequest</a> 和 <a href="https://angular.io/api/common/http/HttpResponse" target="_blank" rel="noopener noreferrer">HttpResponse</a> 实例属性是 <code>只读</code> 的，从而使它们在很大程度上不可变。 — Angular Docs</p></blockquote><p>这是因为我们可能想要在某个请求第一次没成功后重试。不变性确保了拦截器链能够多次重新处理相同的请求。</p><p>你可以使用多个拦截器，但是这个记心中：</p><blockquote><p>Angular 通过你定义他们的顺序应用拦截器。如果你定义的拦截器的顺序是 A-&gt;B-&gt;C，请求将按 A-&gt;B-&gt;C 的顺序流入，响应将按 C-&gt;B-&gt;A 的顺序流入。</p></blockquote><blockquote><p>之后，不能改变顺序或者移除拦截器。如果你需要动态启用、禁用拦截器，你不得不在拦截器本身增加这个功能。— Angular Docs</p></blockquote><p>在示例 APP 中，我们提供了全部拦截器，但是一次仅使用一个。这通过检查路径实现（<a href="https://github.com/melcor76/interceptors/blob/172be0444d505c6164ff506ab311a4966ce8c78f/src/app/interceptors/auth.interceptor.ts#L30" target="_blank" rel="noopener noreferrer">代码在这里</a>）。如果不是我们找的请求，我们通过 <code>next.handle(req)</code> 传递给下一个拦截器。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/01.png" alt="01"></p><p>拦截器的另一个好处是他们能够<code>一起处理请求和响应</code>。我们将看到，这给我们很好的可能性。</p><p>更多深度知识，可以看 <a href="https://medium.com/u/bd29063a4857?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Max Koretskyi aka Wizard</a> 这篇很棒的文章:</p><ul><li><a href="https://medium.com/angular-in-depth/insiders-guide-into-interceptors-and-httpclient-mechanics-in-angular-103fbdb397bf" target="_blank" rel="noopener noreferrer">Angular 拦截器内部指南和 HttpClient 机制</a></li></ul><p>在示例的 HTTP 请求中，我使用了 <a href="https://jsonplaceholder.typicode.com/" target="_blank" rel="noopener noreferrer">JSONPlaceholder</a> 这个网站。如果你想看代码，你可以从这里找到：</p><ul><li><p>10.x 版本，译者版本 <a href="https://github.com/llccing-demo/ng-interceptors" target="_blank" rel="noopener noreferrer">GitHub 示例代码 10.x版本</a> 📜 <a href="https://stackblitz.com/github/" target="_blank" rel="noopener noreferrer">StackBlitz 线上运行</a> 🏃</p></li><li><p>8.x 版本，作者版本 <a href="https://github.com/melcor76/interceptors" target="_blank" rel="noopener noreferrer">GitHub 示例代码 8.x版本</a> 📜 <a href="https://stackblitz.com/github/melcor76/interceptors" target="_blank" rel="noopener noreferrer">StackBlitz 线上运行</a> 🏃</p></li></ul><p>现在，让我们开始倒数吧！</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/02.jfif" alt="02"></p><h2 id="_10-url" tabindex="-1"><a class="header-anchor" href="#_10-url"><span>10.URL</span></a></h2><p>操纵 URL。当我大声说出来时，听起来有些风险，但是让我们看下在拦截器下做这个事情是多么简单。</p><p>例如，我们想从 HTTP 变为 HTTPS。</p><p>就像克隆请求同时使用 https:// 替换 http:// 一样简单。然后我们将克隆的 HTTPS 请求发送到下一个 handler。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 克隆请求，同时使用 https:// 替换 http://</span></span>
<span class="line"><span class="token keyword">const</span> httpsReq <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">url</span><span class="token operator">:</span> req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;http://&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;https://&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>httpsReq<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子中，我们设置 URL 为 HTTP，但是当我们检查请求时，我们能看见它已经变成了 HTTPS。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://jsonplaceholder.typicode.com/todos/1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">this</span><span class="token punctuation">.</span>response <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/03.png" alt="03"></p><p>自动化魔术 https，为什么这个不高明呢。通常你可以通过 web 服务器设置这些事情。或者你想在开发环境从 HTTP 切换到 HTTPS，你可以使用这个 <a href="https://angular.io/cli/serve" target="_blank" rel="noopener noreferrer">CLI</a>:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">ng serve <span class="token operator">-</span>ssl</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>类似，你可以修改一点 URL，并且成它为 API 前缀拦截器：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">req<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">url</span><span class="token operator">:</span> environment<span class="token punctuation">.</span>serverUrl <span class="token operator">+</span> request<span class="token punctuation">.</span>url</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者你可以再次通过 CLI 来实现：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">ng serve <span class="token operator">-</span> serve<span class="token operator">-</span>path<span class="token operator">=</span><span class="token operator">&lt;</span>path<span class="token operator">&gt;</span> <span class="token operator">-</span> base<span class="token operator">-</span>href <span class="token operator">&lt;</span>path<span class="token operator">&gt;</span><span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>感谢 <a href="https://medium.com/u/d91c7d086b4b?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">David Herges</a> 的 CLI 提示。</p><h2 id="_9-loader" tabindex="-1"><a class="header-anchor" href="#_9-loader"><span>9.Loader</span></a></h2><p>当我们等待响应时，每个人都希望看见命运的纺纱轮（表示旋转的loading）。只要在请求活跃的时候，我们在拦截器中统一设置，这样我们就能够看见 loader 了。</p><p>首先，我们能够使用 loader 服务，这样就有了展示和隐藏 loader 的功能。在处理请求前，我们调用<code>展示</code>方法并通过 finalize 完成后<code>隐藏</code> loader。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> loaderService <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>injector<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>LoaderService<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">loaderService<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> loaderService<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子很简单，在真实的解决方案中，我们应该考虑到会有多个 HTTP 请求被拦截。这可以通过一个请求（+1）响应（-1）的计数器来解决这个问题。</p><p>当然，我添加了一个延迟来让我们有时间能够看到 loader。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/04.gif" alt="04"></p><p>全局的 loader 听起来是个不错的主意，但是这个为什么不在列表中呢？可能它适合特定的应用，但是如果你同时加载多个，你可能想要对 loader 定制化。</p><p>我将给你留下一些思考的空间。如果你用 <a href="https://www.learnrxjs.io/operators/transformation/switchmap.html" target="_blank" rel="noopener noreferrer">switchMap</a> 去取消请求将会发生什么？</p><h2 id="_8-转换" tabindex="-1"><a class="header-anchor" href="#_8-转换"><span>8.转换</span></a></h2><p>当 API 返回一个我们不赞同的格式，我们能够使用拦截器去格式化成我们想要的样子。</p><p>这能够从 XML 转换到 JSON，或者像例子中的属性名字从大驼峰拼写到小驼峰拼写。如果后端不关心 JSON/JS 转换，我们能够使用拦截器将全部属性名重命名为小驼峰。</p><p>检查是否有 npm 包能够为你完成繁重的工作。在这个例子中我使用 <a href="https://www.npmjs.com/package/lodash" target="_blank" rel="noopener noreferrer">loadsh</a> 的 <a href="https://lodash.com/docs#mapKeys" target="_blank" rel="noopener noreferrer">mapKeys</a> 和 <a href="https://lodash.com/docs#camelCase" target="_blank" rel="noopener noreferrer">camelCase</a>。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">event</span><span class="token operator">:</span> HttpEvent<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token keyword">instanceof</span> <span class="token class-name">HttpResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">let</span> camelCaseObject <span class="token operator">=</span> <span class="token function">mapKeys</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>body<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span>k</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">camelCase</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">const</span> modEvent <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">body</span><span class="token operator">:</span> camelCaseObjec <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">return</span> modEvent<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个事情通常是后端来做，所以我通常不这么做。但是将这个加入到的兵器库，这样你需要的时候就能够使用了。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/05.gif" alt="05"></p><h2 id="_7-headers" tabindex="-1"><a class="header-anchor" href="#_7-headers"><span>7.Headers</span></a></h2><p>通过操纵 headers 我们能够做许多事，例如：</p><ul><li>认证（authentication）/ 授权（authorization）</li><li>缓存行为；例如，If-Modified-Since</li><li><a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank" rel="noopener noreferrer">XSRF</a> 保护</li></ul><p>我们能够通过拦截器轻而易举的添加 headers。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">cosnt modified <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">setHeaders</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;X-Man&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wolverine&quot;</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>modified<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后我们在开发者工具中就能够看到它被添加到了请求头中。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/06.png" alt="06"></p><p>Angular 使用拦截器来防范 <a href="https://angular.io/guide/http#security-xsrf-protection" target="_blank" rel="noopener noreferrer">跨站请求伪造</a>（XSRF）。通过读取 cookie 中的 <code>XSRF-TOKEN</code> 并设置一个 <code>X-XSRF-TOKEN</code> 请求头来实现。仅仅运行在你的域名中的代码才能够读取 cookie，这样后端能够确定 HTTP 请求来自己客户端程序而不是攻击者。</p><p>如你所见，在拦截器中能够直接操纵 headers。接下来我们将看到更多操纵 headers 的例子。</p><h2 id="_6-通知" tabindex="-1"><a class="header-anchor" href="#_6-通知"><span>6.通知</span></a></h2><p>这里有很多不同的例子用于展示消息。在我的例子中，每次从服务器获得 201 创建状态时，我会展示“Object created.”。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">hadle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">event</span><span class="token operator">:</span> HttpEvent<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token keyword">instanceof</span> <span class="token class-name">HttpResponse</span> <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">201</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span>toastr<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&#39;Object created.&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>或者我们检查对象的类型来展示“Type created”。或者通过将数据和消息包裹到对象中创建一个定制的消息。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">    data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span></span>
<span class="line">    message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/08.gif" alt="08"></p><p>当发生错误的时候，我们也可以通过拦截器展示通知。</p><h2 id="_5-errors" tabindex="-1"><a class="header-anchor" href="#_5-errors"><span>5.Errors</span></a></h2><p>在这个拦截器中我们实现了两个关于错误的用例。</p><p>首先，我们能够<code>重试 HTTP 请求</code>。例如，网络中断在移动端场景很常见，再试一次可能会成功。值得考虑的事情是在放弃之前的重试次数。我们应该在重试前等待吗，或者立即重试？</p><p>对于这点，我们使用 RxJS 中的 <a href="https://rxjs-dev.firebaseapp.com/api/operators/retry" target="_blank" rel="noopener noreferrer">retry</a> 操作符重新订阅 observable。HttpClient 方法调用的重新订阅具有再次发出 HTTP 请求的效果。</p><p>这种行为的更高级的示例：</p><ul><li><a href="https://www.learnrxjs.io/operators/error_handling/retrywhen.html" target="_blank" rel="noopener noreferrer">当发生错误时，基于自定义标准重试 observable 序列</a></li><li><a href="https://medium.com/angular-in-depth/power-of-rxjs-when-using-exponential-backoff-a4b8bde276b0" target="_blank" rel="noopener noreferrer">当使用幂等回退时 rxjs 的能力</a></li></ul><p>第二点，检查异常的状态。基于状态，决定应该做什么。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">retry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">catchError</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">error</span><span class="token operator">:</span> HttpErrorResponse</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// 401 在 auth.interceptor 中处理了</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span>toastr<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token function">throwError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子中，在检查错误状态前，我们重试了两次。如果状态不是 401，我们已弹出（toastr）的形式展示错误。所有的错误将重新抛出来进一步处理。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/09.png" alt="09"></p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/10.png" alt="10"></p><p>更多的错误处理的知识，你可以在这里阅读我早期的文章：</p><ul><li><a href="https://medium.com/angular-in-depth/expecting-the-unexpected-best-practices-for-error-handling-in-angular-21c3662ef9e4" target="_blank" rel="noopener noreferrer">期待意外 -- Angular 错误处理的最佳实践</a></li></ul><h2 id="_4-分析" tabindex="-1"><a class="header-anchor" href="#_4-分析"><span>4.分析</span></a></h2><p>因为拦截器能够同时处理请求和响应，能够在一次完整的 HTTP 操作中计时和记日志。所以我们能够捕获请求和响应时间，记录经过的时间结果。</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">const</span> started <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> ok<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">tap</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token punctuation">(</span>event<span class="token operator">:</span> HttpEvent<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ok <span class="token operator">=</span> event <span class="token keyword">instanceof</span> <span class="token class-name">HttpResponse</span> <span class="token operator">?</span> <span class="token string">&#39;successed&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">(</span>error<span class="token operator">:</span> HttpEventResponse<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ok <span class="token operator">=</span> <span class="token string">&#39;failed&#39;</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// 响应 observable 结束或者完成的时候记日志</span></span>
<span class="line">    <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> elapsed <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> started<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>urlWithParams<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ok<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>elapsed<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ms.</span><span class="token template-punctuation string">`</span></span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这有许多中可能，例如，我们能记录分析日志到数据库中做统计。这个例子中，我们输出到 console。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/11.png" alt="11"></p><h2 id="_3-伪造后端" tabindex="-1"><a class="header-anchor" href="#_3-伪造后端"><span>3. 伪造后端</span></a></h2><p>当没有后端服务时，可以在开发中模拟或者伪装后端。你也可以将其用于 StackBlitz 中托管的代码。</p><p>我们基于请求模拟返回，然后返回一个 HttpResponse observable。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&#39;mock&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&#39;Faker&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpResponse</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token literal-property property">body</span><span class="token operator">:</span> body <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/12.gif" alt="12"></p><h2 id="_2-缓存" tabindex="-1"><a class="header-anchor" href="#_2-缓存"><span>2. 缓存</span></a></h2><p>因为拦截器能够自己处理请求，没有转发到 <code>next.handle()</code>，所以我们利用这一点来缓存请求。</p><p>在 key-value map 构成的缓存中，我们使用 URL 作为 key。如果我们响应在 map 中，我们能够通过 <code>next</code> handler 返回这个 observable 响应。</p><p>当你已经有响应缓存时，你不需要一路走到后端，这个提升了性能。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@angular/core&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> HttpEvent<span class="token punctuation">,</span> HttpRequest<span class="token punctuation">,</span> HttpHandler<span class="token punctuation">,</span> HttpInterceptor<span class="token punctuation">,</span> HttpResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@angular/common/http&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Observable<span class="token punctuation">,</span> <span class="token keyword">of</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;rxjs&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> tap<span class="token punctuation">,</span> shareReplay <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;rxjs/operators&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CacheInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HttpInterceptor</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">intercept</span><span class="token punctuation">(</span>request<span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token literal-property property">next</span><span class="token operator">:</span> HttpHandler<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>HttpEvent<span class="token operator">&lt;</span>any<span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method <span class="token operator">!==</span> <span class="token string">&#39;Get&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">const</span> cacheResponse <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span>cacheResponse<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token keyword">instanceof</span> <span class="token class-name">HttpResponse</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果我们运行这个请求，清空响应然后再次运行将使用缓存。</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/13.gif" alt="13"></p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/14.png" alt="14"></p><p>如果数据更新了，你需要使缓存失效，这会引入一些复杂性。但是现在不用担心！缓存生效的时候是真的爽！</p><p>关于缓存的更多知识可以读 <a href="https://medium.com/u/6317765dd4e6?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Dominic E.</a> 的这篇很帮的文章：</p><ul><li><a href="https://blog.thoughtram.io/angular/2018/03/05/advanced-caching-with-rxjs.html" target="_blank" rel="noopener noreferrer">RxJS 高级缓存</a></li></ul><h2 id="_1-认证" tabindex="-1"><a class="header-anchor" href="#_1-认证"><span>1.认证</span></a></h2><p>清单中的第一个是认证！对于很多应用来说他是基本的，我们已经有了适当的认证系统。这是拦截器最常见的用例之一，有充分的理由。恰到好处！</p><p>有几个和权限相关的事情我们能做：</p><ol><li>添加 bearer token</li><li>重新刷新 token</li><li>重定向到登录页</li></ol><p>当我们发送 bearer token 时，我们也应该有些过滤。如果我们还没 token，我们可能在登录，并不需要添加 token。或者如果我们调用其他域名，我们也不希望添加 token。例如，如果<a href="https://medium.com/dailyjs/how-to-send-errors-into-slack-dc552e30506f" target="_blank" rel="noopener noreferrer">向 Slack 发送错误信息</a>。</p><p>相比于其他拦截器这个会有点复杂。这是一个带有一些解释性注释的例子：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@angular/core&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> HttpEvent<span class="token punctuation">,</span> HttpInterceptor<span class="token punctuation">,</span> HttpHandler<span class="token punctuation">,</span> HttpRequest<span class="token punctuation">,</span> HttpErrorResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@angular/common/http&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> throwError<span class="token punctuation">,</span> Observable<span class="token punctuation">,</span> BehaviorSubject<span class="token punctuation">,</span> <span class="token keyword">of</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;rxjs&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> catchError<span class="token punctuation">,</span> filter<span class="token punctuation">,</span> take<span class="token punctuation">,</span> switchMap <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;rxjs/operators&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AuthInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HttpInterceptor</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token constant">AUTH_HEADER</span> <span class="token operator">=</span> <span class="token string">&#39;Authorization&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> token <span class="token operator">=</span> <span class="token string">&#39;secrettoken&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> refreshTokenInProgress <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> refreshTokenSubject<span class="token operator">:</span> BehaviorSubject<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BehaviorSubject<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">intercept</span><span class="token punctuation">(</span>req<span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> next<span class="token operator">:</span> HttpHandler<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>HttpEvent<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">&#39;Content-type&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            req <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">                headers<span class="token operator">:</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        req <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addAuthenticationToken</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token function">cacheError</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token operator">:</span> HttpErrorResponse<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenInProgress<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenSubject<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token function">filter</span><span class="token punctuation">(</span>result <span class="token operator">=&gt;</span> result <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token function">take</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                            <span class="token function">switchMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addAuthenticationToken</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenInProgress <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                        <span class="token comment">// 设置 refreshTokenSubject 为 null，这样随后的 API 将等到新的 token 被取回时才调用。</span></span>
<span class="line">                        <span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenSubject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refreshAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span></span>
<span class="line">                            <span class="token function">switchMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span>success<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                                <span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenSubject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                                <span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addAuthenticationToken</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line">                            <span class="token comment">// 当我们调用刷新 token 方法完成时，重置 refreshTokenInProgress 为 false，</span></span>
<span class="line">                            <span class="token comment">// 这是为了下次 token 需要再次被刷新</span></span>
<span class="line">                            <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>refreshTokenInProgress <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">return</span> <span class="token function">throwError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token function">refreshAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token string">&#39;secret token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token function">addAuthenticationToken</span><span class="token punctuation">(</span>request<span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> HttpRequest<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 如果还没有 token，不应该在 header 中设置 token。</span></span>
<span class="line">        <span class="token comment">// 首先我们应该从存储 token 的地方取回</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> request<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// 如果访问外部域名不应该添加 token</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>request<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">www.mydomain.com\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> request<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">            headers<span class="token operator">:</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">AUTH_HEADER</span><span class="token punctuation">,</span> <span class="token string">&#39;Bearer &#39;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>大吉大利，今晚吃鸡！🚀</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>拦截器是 Angular 4.3 中一个重要的功能，这里我们看到了很多很棒的功能。现在发挥你的创造力，我相信你可以想出一些有趣的东西！</p><p>记住，通过使用拦截器，你可以像蝙蝠侠一样棒！</p><p><img src="http://static.llccing.cn/front-end/top-10-ways-to-use-interceptors/15.jfif" alt="15"></p><ul><li><p>10.x 版本，译者版本 <a href="https://github.com/llccing-demo/ng-interceptors" target="_blank" rel="noopener noreferrer">GitHub 示例代码 10.x版本</a> 📜 <a href="https://stackblitz.com/github/" target="_blank" rel="noopener noreferrer">StackBlitz 线上运行</a> 🏃</p></li><li><p>8.x 版本，作者版本 <a href="https://github.com/melcor76/interceptors" target="_blank" rel="noopener noreferrer">GitHub 示例代码 8.x版本</a> 📜 <a href="https://stackblitz.com/github/melcor76/interceptors" target="_blank" rel="noopener noreferrer">StackBlitz 线上运行</a> 🏃</p></li></ul><p>感谢 Angular In Depth 提供想法和帮助编辑文档。希望我没有忘记任何一个人，谢谢 <a href="https://medium.com/u/bd29063a4857?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Max Koretskyi aka Wizard</a>，<a href="https://medium.com/u/802a7996f6b6?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Tim Deschryver</a>，<a href="https://medium.com/u/f7828ad40c7c?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Alex Okrushko</a>，<a href="https://medium.com/u/ae97ac398bf9?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Alexander Poshtaruk</a>，<a href="https://medium.com/u/f0e7507974eb?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Lars Gyrup Brink Nielsen</a>，<a href="https://medium.com/u/e0ccd74b3326?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Nacho Vazquez Calleja</a>，<a href="https://medium.com/u/73c42fbc4665?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">thekiba</a> &amp; <a href="https://medium.com/u/d59a9e801370?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Alexey Zuev</a>!</p><h2 id="资源" tabindex="-1"><a class="header-anchor" href="#资源"><span>资源</span></a></h2><ul><li><p><a href="https://medium.com/angular-in-depth/insiders-guide-into-interceptors-and-httpclient-mechanics-in-angular-103fbdb397bf" target="_blank" rel="noopener noreferrer">Angular 拦截器内部指南和 HttpClient 机制</a> by <a href="https://medium.com/u/bd29063a4857?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">Max Koretskyi</a>，<a href="https://medium.com/u/bd29063a4857?source=post_page-----db450f8a62d6--------------------------------" target="_blank" rel="noopener noreferrer">aka Wizard</a></p></li><li><p><a href="https://angular.io/guide/http#intercepting-requests-and-responses" target="_blank" rel="noopener noreferrer">Angular 文档</a></p></li><li><p>许多其他好文章中的点点滴滴</p></li></ul><h2 id="译者参考" tabindex="-1"><a class="header-anchor" href="#译者参考"><span>译者参考</span></a></h2><ul><li><a href="https://www.ruanyifeng.com/blog/2007/06/camelcase.html" target="_blank" rel="noopener noreferrer">驼峰拼写法</a></li><li><a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0" target="_blank" rel="noopener noreferrer">XSRF/CSRF</a></li></ul><h2 id="感谢阅读" tabindex="-1"><a class="header-anchor" href="#感谢阅读"><span>感谢阅读</span></a></h2><p>感谢你阅读到这里，翻译的不好的地方，还请指点。希望我的内容能让你受用，再次感谢。<a href="https://llccing.github.io/FrontEnd/" target="_blank" rel="noopener noreferrer">by llccing 千里</a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link label" href="https://github.com/llccing/FrontEnd/edit/main/blog/translate/Top 10 ways to use Interceptors in Angular.md" aria-label="Edit this page" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><svg class="edit-icon" viewbox="0 0 1024 1024"><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]--><!--]-->Edit this page<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><time class="meta-item-info" datetime="2026-01-12T10:15:45.000Z" data-allow-mismatch>2026/1/12 10:15</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: lcf33123@gmail.com">Rowan Liu</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link route-link-active auto-link prev" href="/FrontEnd/blog/translate/" aria-label="开篇"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">开篇</span></div><!--]--></a><a class="route-link auto-link next" href="/FrontEnd/blog/translate/what-you-need-know-about-Vue-3-in-2020.html" aria-label="2020年关于 Vue 3 你需要知道的事"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">2020年关于 Vue 3 你需要知道的事</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/FrontEnd/assets/app-DxUSmTbc.js" defer></script>
  </body>
</html>
